'''
定义一个apk的所有图，
输入一个反编译apk的路径
返回第一种类型的图，每个函数对应一个操作码调用图
返回
'''

from opcode_generator import gen_method_lines
import SmaliMethod
class Apk:

    def __init__(self, apkPath):
        # 生成一个函数的字典，键值对为：函数--函数的行
        self.method_line_dict = gen_method_lines(apkPath)
        # 生成所有函数的类
        self.method_class_dict = self.gen_method_class()

    def gen_method_class(self):
        method_class_dict = {}
        for method_name in list(self.method_line_dict.keys()):
            method_class_dict[method_name] = SmaliMethod.SmaliMethod(method_name, self.method_line_dict[method_name])
        return method_class_dict
